<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>The Archives â€” CRT</title>
  <style>
    :root{
      --crt-blue:#0af;
      --bg:#000;
      --card:#020813;
      --accent:#0af;
      --glass:rgba(0,20,40,0.3);
    }

    /* Base */
    html,body{height:100%;margin:0;font-family:"Courier New",monospace;background:var(--bg);color:var(--crt-blue);letter-spacing:0.4px}

    /* Make everything static */
    *{animation:none !important;transition:none !important}

    /* CRT overlays */
    /* Stronger scanlines */
    body::before{
      content:"";
      position:fixed;
      top:0;left:0;width:100%;height:100%;pointer-events:none;
      background:
        repeating-linear-gradient(
          to bottom,
          rgba(255,255,255,0.10) 0px,
          rgba(255,255,255,0.10) 1px,
          rgba(0,0,0,0) 3px,
          rgba(0,0,0,0) 6px
        ),
        repeating-linear-gradient(
          to right,
          rgba(0,150,255,0.05) 0px,
          rgba(0,150,255,0.05) 1px,
          rgba(0,0,0,0) 2px,
          rgba(0,0,0,0) 4px
        );
      mix-blend-mode:screen;
      z-index:99999;
    }
    /* Subpixel RGB mask (horizontal stripes) */
    body::after{
      content:"";
      position:fixed;
      top:0;left:0;width:100%;height:100%;pointer-events:none;
      background:
        radial-gradient(circle at center,
          rgba(0,0,0,0) 50%,
          rgba(0,0,0,0.8) 100%
        );
      filter:blur(2px);
      z-index:99998;
    }
    /* Strong vignette + curved screen illusion using radial gradient */
    .crt-vignette{position:fixed;inset:0;pointer-events:none;z-index:99992;background:radial-gradient(ellipse at center, rgba(255,255,255,0) 45%, rgba(0,0,0,0.5) 100%)}

    /* Slight barrel distortion illusion on the main wrapper */
    .crt-wrap{position:relative;width:100%;height:100%;overflow:hidden;display:flex;flex-direction:column}
    .crt-screen{
      transform:perspective(800px) translateZ(0);
      filter:contrast(1.05) saturate(1.05);
      padding:0;margin:0;min-height:100vh;
      display:flex;flex-direction:column;
    }

    /* Global CRT text splitting (subtle) */
    /* Uses layered text-shadow for line-splitting / chromatic separation */
    .crt-text, .crt-text *{
      color:var(--crt-blue);
      text-shadow:
        0 0 6px rgba(10,175,255,0.95), /* glow */
        1px 0 0 rgba(255,0,128,0.06),  /* magenta offset */
        -1px 0 0 rgba(0,200,255,0.06); /* cyan offset */
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* SPLASH (static) */
    #splash{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:99995}
    .splash-title{font-size:2.6rem;font-weight:700}
    .splash-sub{color:rgba(10,175,255,0.7);margin-top:8px;font-size:0.9rem}

    /* LOCKSCREEN */
    #lockscreen{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(180deg,#000,#00101a);display:flex;flex-direction:column;align-items:center;justify-content:center;font-family:"Courier New",monospace;z-index:99994}
    #lockText{font-size:1.1rem;margin-bottom:1rem}
    #lockInput{background:transparent;color:var(--crt-blue);border:1px solid rgba(10,175,255,0.5);padding:10px;width:260px;font-size:1rem;text-align:center}
    #lockBtn{margin-top:12px;background:transparent;color:var(--crt-blue);border:1px solid rgba(10,175,255,0.6);padding:10px 20px;cursor:pointer}

    /* MAIN SITE */
    .viewport{height:100vh;scroll-snap-type:y mandatory;overflow-y:scroll;display:none}
    section{height:100vh;display:flex;align-items:center;justify-content:center;scroll-snap-align:center;padding:2rem;box-sizing:border-box}
    .bar{width:min(900px,95%);background:linear-gradient(180deg, rgba(0,8,15,0.6), rgba(0,6,10,0.55));border-radius:6px;padding:24px;border:1px solid rgba(10,175,255,0.15);box-shadow:inset 0 0 60px rgba(10,175,255,0.03),0 0 40px rgba(10,175,255,0.04)}
    .bar h2{margin:0 0 8px 0;font-size:1.2rem;color:var(--crt-blue)}
    .controls{display:flex;gap:8px;align-items:center}
    .controls input{flex:1;padding:10px;border-radius:4px;border:1px solid rgba(10,175,255,0.12);background:transparent;color:var(--crt-blue)}
    .controls button{padding:10px 14px;border-radius:4px;border:1px solid rgba(10,175,255,0.15);background:transparent;color:var(--crt-blue);cursor:pointer}
    .protected-text{margin-top:18px;display:none;background:rgba(0,0,0,0.45);padding:14px;border-radius:4px;border:1px solid rgba(10,175,255,0.08)}
    .unlocked{display:block}
    .edit-btn{margin-top:10px;padding:6px 10px;border-radius:4px;background:transparent;color:var(--crt-blue);border:1px solid rgba(10,175,255,0.12);cursor:pointer;font-size:.9rem}

    #adminPanel{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);display:none;align-items:center;justify-content:center;color:var(--crt-blue)}
    #adminPanel .panel{background:linear-gradient(180deg,#000,#00101a);padding:20px;border-radius:6px;border:1px solid rgba(10,175,255,0.12);width:90%;max-width:420px}
    #adminPanel input,#adminPanel textarea{width:100%;padding:10px;margin:6px 0;border-radius:4px;border:1px solid rgba(10,175,255,0.12);background:transparent;color:var(--crt-blue)}

    #exportBtn{position:fixed;right:12px;bottom:12px;padding:10px 14px;border-radius:4px;background:transparent;border:1px solid rgba(10,175,255,0.12);color:var(--crt-blue);font-weight:700;cursor:pointer;display:none}

    /* Subtle fine noise to resemble phosphor grain */
    .noise{
      position:fixed;inset:0;pointer-events:none;z-index:99993;background-image:linear-gradient(transparent, rgba(255,255,255,0.01));opacity:0.6;
      background-size:4px 4px;
    }

    /* Responsive tweaks */
    @media (max-width:520px){.splash-title{font-size:1.6rem}.bar{padding:18px}}
  </style>
</head>
<body>
  <div class="crt-wrap crt-text">
    <div class="crt-screen">

      <!-- SPLASH (static) -->
      <div id="splash" class="crt-text">
        <div class="splash-title">THE ARCHIVES</div>
        <div class="splash-sub">[ ðŸ’¾ ]</div>
      </div>

      <!-- LOCKSCREEN -->
      <div id="lockscreen" class="crt-text">
        <div id="lockText">ENTER ACCESS PASSWORD:</div>
        <input id="lockInput" type="password" placeholder="Password">
        <button id="lockBtn">UNLOCK</button>
      </div>

      <!-- MAIN SITE -->
      <button id="enterAdmin" style="position:fixed;top:12px;right:12px;padding:8px 12px;border-radius:6px;border:1px solid rgba(10,175,255,0.12);background:transparent;color:var(--crt-blue);font-weight:700;cursor:pointer">Admin</button>
      <button id="exportBtn">Download Updated HTML</button>

      <div class="viewport" id="viewport">
<section><div class="bar">
<h2>1985 <span class="locked-badge">Locked</span></h2>
<div class="controls"><input type="password" class="pw-input"><button class="pw-btn">Unlock</button></div>
<div class="protected-text">Diary log 1
Hello. I am ***********
I have just joined this school...</div>
<button class="edit-btn">Edit</button>
</div></section>
<section><div class="bar">
<h2>The Archives <span class="locked-badge">Locked</span></h2>
<div class="controls"><input type="password" class="pw-input"><button class="pw-btn">Unlock</button></div>
<div class="protected-text">Hello. I am not at all certain...</div>
<button class="edit-btn">Edit</button>
</div></section>
<section><div class="bar">
<h2>The Clues <span class="locked-badge">Locked</span></h2>
<div class="controls"><input type="password" class="pw-input"><button class="pw-btn">Unlock</button></div>
<div class="protected-text">How are you getting these hints...</div>
<button class="edit-btn">Edit</button>
</div></section>
</div>

      <div id="adminPanel"><div class="panel">
        <h3>Edit Bar</h3>
        <label>Title</label><input id="editTitle">
        <label>Password</label><input id="editPassword" type="password">
        <label>Protected Text</label><textarea id="editText" rows="4"></textarea>
        <button id="saveEdit" style="margin-top:10px;border:1px solid rgba(10,175,255,0.12);background:transparent;color:var(--crt-blue);padding:10px;border-radius:6px;cursor:pointer">Save</button>
        <button id="closeAdmin" style="margin-top:10px;border:1px solid rgba(10,175,255,0.12);background:transparent;color:var(--crt-blue);padding:10px;border-radius:6px;cursor:pointer">Cancel</button>
      </div></div>

      <div class="noise"></div>
      <div class="crt-vignette"></div>

    </div>
  </div>

<script>
// DEFAULT BARS
const defaultBars=[
  {title:"1985",password:"1985pass",text:"Diary log content..."},
  {title:"The Archives",password:"archpass",text:"Archive content..."},
  {title:"The Clues",password:"cluepass",text:"Clues content..."}
];
let bars=JSON.parse(localStorage.getItem('bars-data')||'null')||defaultBars;

async function sha256hex(msg){
  const data=new TextEncoder().encode(msg);
  const hash=await crypto.subtle.digest('SHA-256',data);
  return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

// RENDER BARS
async function render(){
  const viewport=document.getElementById('viewport');
  viewport.innerHTML='';
  for(let i=0;i<bars.length;i++){
    const bar=document.createElement('section');
    const content=document.createElement('div');
    content.className='bar crt-text';
    const hash=await sha256hex(bars[i].password);

    content.innerHTML = `
      <h2>${bars[i].title} <span class="locked-badge">Locked</span></h2>
      <div class="controls">
        <input type="password" placeholder="Enter password" class="pw-input" />
        <button class="pw-btn">Unlock</button>
      </div>
      <div class="protected-text">${bars[i].text}</div>
      <button class="edit-btn">Edit</button>
    `;

    const input=content.querySelector('.pw-input');
    const btn=content.querySelector('.pw-btn');
    const text=content.querySelector('.protected-text');
    const badge=content.querySelector('.locked-badge');

    btn.onclick = async ()=>{
      if(await sha256hex(input.value) === hash){
        text.classList.add('unlocked');
        badge.textContent='Unlocked';
      }
    };

    content.querySelector('.edit-btn').onclick = ()=>openAdmin(i);
    bar.appendChild(content);
    viewport.appendChild(bar);
  }
}
render();

// ADMIN LOGIN
let adminUnlocked=false;
document.getElementById('enterAdmin').onclick = ()=>{
  const pw=prompt('Enter admin password:');
  if(pw === 'admin123'){adminUnlocked=true;document.getElementById('exportBtn').style.display='block';alert('Admin mode enabled.')}else alert('Wrong password.');
};

// ADMIN EDIT PANEL
let editIndex=null;
function openAdmin(i){
  if(!adminUnlocked){alert('Admin mode locked.');return;}
  editIndex=i;
  document.getElementById('editTitle').value=bars[i].title;
  document.getElementById('editPassword').value=bars[i].password;
  document.getElementById('editText').value=bars[i].text;
  document.getElementById('adminPanel').style.display='flex';
}
document.getElementById('closeAdmin').onclick = ()=>{document.getElementById('adminPanel').style.display='none'}
document.getElementById('saveEdit').onclick = ()=>{
  bars[editIndex].title=document.getElementById('editTitle').value;
  bars[editIndex].password=document.getElementById('editPassword').value;
  bars[editIndex].text=document.getElementById('editText').value;
  localStorage.setItem('bars-data', JSON.stringify(bars));
  document.getElementById('adminPanel').style.display='none';
  render();
}

// EXPORT
document.getElementById('exportBtn').onclick = ()=>{
  const a=document.createElement('a');
  a.href='data:text/html,'+encodeURIComponent(document.documentElement.outerHTML);
  a.download='updated-crt.html';
  a.click();
}

// LOCKSCREEN LOGIC
const lockBtn=document.getElementById('lockBtn');
lockBtn.onclick = ()=>{
  const pw=document.getElementById('lockInput').value;
  if(pw === 'ANTIX238'){
    document.getElementById('lockscreen').style.display='none';
    document.getElementById('splash').style.display='none';
    document.getElementById('viewport').style.display='block';
  } else alert('Incorrect password');
}

// Force-remove splash after 1 second
setTimeout(()=>{
  const s=document.getElementById('splash');
  if(s) s.style.display='none';
  const l=document.getElementById('lockscreen');
  if(l) l.style.display='flex';
},1000);

</script>
</body>
</html>
